import pandas as pd

configfile: "configs/config.yaml"


df_lrgasp = pd.read_csv(config['lrgasp']['config'], sep='\t')


def genome(wildcards):
    if 'genome' in wildcards.keys():
        return wildcards.genome

    if wildcards.sample == 'ES':
        return 'mm39'
    elif wildcards.sample == 'WTC11':
        return 'hg38'
    # if wildcards.sample == 'gm12878':
    #     return 'human'
    # elif wildcards.sample == 'c2c12':
    #     return 'mouse'
    else:
        raise ValueError(f'{wildcards.sample} is not known sample')


def fasta(wildcards):
    return config['genome']['fasta'][genome(wildcards)]


def gtf(wildcards):
    return config['genome']['gtf'][genome(wildcards)]


def chrom_sizes(wildcards):
    return config['common']['chrom_sizes'].format(genome=genome(wildcards))


def star_index(wildcards):
    return config['genome']['star_index'][genome(wildcards)]


# df_lrgasp = df_lrgasp[
#     (df_lrgasp['file_contents'] == 'reads') &
#     (df_lrgasp['library_prep'] == 'dRNA') &
#     (df_lrgasp['sample'] == 'WTC11')
# ]


# def read_annot(wildcards):
#     if wildcards.sample == 'gm12878':
#         return config['pilot']['read_annot']
#     elif wildcards.sample == 'c2c12':
#         return config['c2c12']['read_annot_bulk']
#     else:
#         raise('readannot is not defined for `%s`' % wildcards.sample)

include: "common/Snakefile"
include: "long_reads/Snakefile"
include: "short_rnaseq/Snakefile"
include: "benchmark/Snakefile"
include: "correction/Snakefile"
include: "wg_encode/Snakefile"

# include: "quantseq3/Snakefile"
# include: "wtc11/Snakefile"
# include: "read3/Snakefile"
# include: "c2c12/Snakefile"
# include: "pilot/Snakefile"



rule all:
    input:
        rules.all_short_rnaseq.input,
        rules.all_long_rnaseq.input,
        # rules.all_wg_encode.input

        # expand(rules.plot_overlap_annotation.output,
        #        sample='WTC11', library_prep='cDNA',
        #        platform='PacBio', counting='end')

        # expand(config['talon']['gtf_corrected'],
        #        sample='WTC11', library_prep='cDNA',
        #        platform='PacBio', counting='end')
