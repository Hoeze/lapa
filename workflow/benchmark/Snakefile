rule benchmark_lapa:
    input:
        short_rna = config['lapa']['lapa_dir'].format(
            sample='gm12878', dataset='short_rna_lapa'),
        quantseq = config['lapa']['lapa_dir'].format(
            sample='gm12878', dataset='quantseq_lapa'),
        long_rna_gm12 = config['lapa']['lapa_dir'].format(
            sample='gm12878', dataset='long_rna_lapa')
    output:
        rep1 = 'reports/figures/gm12878_rep1_pr_curve.png',
        rep2 = 'reports/figures/gm12878_rep2_pr_curve.png'
    notebook:
        'benchmark_lapa.ipynb'


rule overlap_gm12_pc_talon:
    input:
        clusters = config['lapa']['quantseq_dir'].format(sample='gm12878'),
        gtf = config['long_read']['gm12878']['gtf_talon'],
        abundance = config['long_read']['gm12878']['abundance']
    params:
        max_distance = 50,
        tpm_columns = ['PB_GM12878_R1', 'PB_GM12878_R2']
    output:
        overlap = 'data/processed/annotation_overlap/gm12_overlap.tsv'
    script:
        "./overlap_talon_quanseq.py"
